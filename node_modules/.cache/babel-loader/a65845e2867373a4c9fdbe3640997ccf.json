{"ast":null,"code":"var _jsxFileName = \"/media/mamun/Tools/iocommerce/admin/src/pages/auth/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport './style.scss';\nimport jwtDecode from 'jwt-decode';\nimport { useForm } from 'react-hook-form';\nimport { Images } from '../../utils/Images';\nimport { Link, useHistory } from 'react-router-dom';\nimport { PrimaryButton } from '../../components/button/Index';\nimport { routes } from '../../routes/Index';\nimport Requests from '../../utils/Requests/Index';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = () => {\n  _s();\n\n  const history = useHistory();\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm();\n  const [isLogging, setLogging] = useState(false); // Handle redirect\n\n  const handleRedirect = token => {\n    let redirecPath = null;\n    const decode = jwtDecode(token);\n    const permissions = decode.permissions; // Filter permitted routes from given permissions\n\n    if (routes && routes.length) {\n      const isAll = permissions.find(item => item === \"all\");\n\n      if (isAll) {\n        redirecPath = \"/dashboard/\";\n      } else {\n        const permittedRoutes = routes.filter(({\n          name: routeName\n        }) => permissions.some(x => x === routeName));\n        const redirec = permittedRoutes[0];\n\n        if (redirec.path) {\n          redirecPath = redirec.path;\n        } else {\n          redirecPath = redirec.child[0].path;\n        }\n      }\n    }\n\n    return redirecPath;\n  };\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      const path = handleRedirect(token);\n      if (path) return history.push(path);\n    }\n  }, [history]); // Submit Form\n\n  const onSubmit = async data => {\n    setLogging(true);\n    const response = await Requests.Auth.Login(data);\n\n    if (response && response.token) {\n      setLogging(false);\n      const path = handleRedirect(response.token);\n\n      if (path) {\n        localStorage.setItem('token', response.token);\n        return history.push(path);\n      }\n    }\n\n    setLogging(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-lg-6 d-none d-lg-block p-0\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-container\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"overlay\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-center flex-column\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: Images.Logo,\n                  className: \"img-fluid\",\n                  alt: \"...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 76,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                  children: \"admin panel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 77,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Login as admin, manage users & products.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 78,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 75,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-lg-6 py-3 credential-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-center flex-column\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card border-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center text-lg-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-lg-none\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: Images.Logo,\n                    className: \"img-fluid\",\n                    alt: \"...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 89,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"mb-0 mb-lg-4\",\n                  children: \"Get Started!\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 91,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"d-lg-none mb-4\",\n                  children: \"Login as admin, manage users & products.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 92,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: handleSubmit(onSubmit),\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group mb-4\",\n                  children: [errors.email && errors.email.message ? /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-danger\",\n                    children: errors.email && errors.email.message\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 100,\n                    columnNumber: 45\n                  }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"E-mail\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 101,\n                    columnNumber: 47\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"text\",\n                    className: \"form-control shadow-none\",\n                    placeholder: \"Enter e-mail\",\n                    ...register(\"email\", {\n                      required: \"E-mail is required\",\n                      pattern: {\n                        value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\n                        message: \"Invalid email address\"\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 103,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 98,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group mb-4\",\n                  children: [errors.password && errors.password.message ? /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-danger\",\n                    children: errors.password && errors.password.message\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 120,\n                    columnNumber: 45\n                  }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"Password\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 121,\n                    columnNumber: 47\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"password\",\n                    className: \"form-control shadow-none\",\n                    placeholder: \"Enter password\",\n                    ...register(\"password\", {\n                      required: \"Please enter password\",\n                      minLength: {\n                        value: 8,\n                        message: \"Minimun length 8 character\"\n                      }\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 123,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 118,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: /*#__PURE__*/_jsxDEV(Link, {\n                      to: \"/reset\",\n                      children: \"Forgot password ?\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 140,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 139,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"ms-auto\",\n                    children: /*#__PURE__*/_jsxDEV(PrimaryButton, {\n                      type: \"submit\",\n                      className: \"px-4\",\n                      disabled: isLogging,\n                      children: isLogging ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: \"Logging in...\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 147,\n                        columnNumber: 59\n                      }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: \"Login\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 147,\n                        columnNumber: 88\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 143,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Login, \"6/VHctMn95s1ZlqAWIoQjRNG7eo=\", false, function () {\n  return [useHistory, useForm];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/media/mamun/Tools/iocommerce/admin/src/pages/auth/Login.js"],"names":["React","useEffect","useState","jwtDecode","useForm","Images","Link","useHistory","PrimaryButton","routes","Requests","Login","history","register","handleSubmit","formState","errors","isLogging","setLogging","handleRedirect","token","redirecPath","decode","permissions","length","isAll","find","item","permittedRoutes","filter","name","routeName","some","x","redirec","path","child","localStorage","getItem","push","onSubmit","data","response","Auth","setItem","Logo","email","message","required","pattern","value","password","minLength"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport './style.scss'\nimport jwtDecode from 'jwt-decode'\nimport { useForm } from 'react-hook-form'\nimport { Images } from '../../utils/Images'\nimport { Link, useHistory } from 'react-router-dom'\nimport { PrimaryButton } from '../../components/button/Index'\nimport { routes } from '../../routes/Index'\nimport Requests from '../../utils/Requests/Index'\n\nconst Login = () => {\n    const history = useHistory()\n    const { register, handleSubmit, formState: { errors } } = useForm()\n    const [isLogging, setLogging] = useState(false)\n\n    // Handle redirect\n    const handleRedirect = token => {\n\n        let redirecPath = null\n        const decode = jwtDecode(token)\n        const permissions = decode.permissions\n\n        // Filter permitted routes from given permissions\n        if (routes && routes.length) {\n            const isAll = permissions.find(item => item === \"all\")\n\n            if (isAll) {\n                redirecPath = \"/dashboard/\"\n            } else {\n                const permittedRoutes = routes.filter(({ name: routeName }) => permissions.some(x => x === routeName))\n                const redirec = permittedRoutes[0]\n\n                if (redirec.path) {\n                    redirecPath = redirec.path\n                } else {\n                    redirecPath = redirec.child[0].path\n                }\n            }\n        }\n        return redirecPath\n    }\n\n    useEffect(() => {\n        const token = localStorage.getItem('token')\n        if (token) {\n            const path = handleRedirect(token)\n            if (path) return history.push(path)\n        }\n    }, [history])\n\n    // Submit Form\n    const onSubmit = async (data) => {\n        setLogging(true)\n        const response = await Requests.Auth.Login(data)\n        if (response && response.token) {\n            setLogging(false)\n            const path = handleRedirect(response.token)\n\n            if (path) {\n                localStorage.setItem('token', response.token)\n                return history.push(path)\n            }\n        }\n        setLogging(false)\n    }\n\n\n    return (\n        <div className=\"auth\">\n            <div className=\"container-fluid\">\n                <div className=\"row\">\n                    <div className=\"col-12 col-lg-6 d-none d-lg-block p-0\">\n                        <div className=\"image-container\">\n                            <div className=\"overlay\">\n                                <div className=\"flex-center flex-column\">\n                                    <img src={Images.Logo} className=\"img-fluid\" alt=\"...\" />\n                                    <h2>admin panel</h2>\n                                    <p>Login as admin, manage users & products.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"col-12 col-lg-6 py-3 credential-container\">\n                        <div className=\"flex-center flex-column\">\n                            <div className=\"card border-0\">\n                                <div className=\"text-center text-lg-start\">\n                                    <div className=\"d-lg-none\">\n                                        <img src={Images.Logo} className=\"img-fluid\" alt=\"...\" />\n                                    </div>\n                                    <h3 className=\"mb-0 mb-lg-4\">Get Started!</h3>\n                                    <p className=\"d-lg-none mb-4\">Login as admin, manage users & products.</p>\n                                </div>\n\n                                <form onSubmit={handleSubmit(onSubmit)}>\n\n                                    {/* E-mail */}\n                                    <div className=\"form-group mb-4\">\n                                        {errors.email && errors.email.message ?\n                                            <p className=\"text-danger\">{errors.email && errors.email.message}</p>\n                                            : <p>E-mail</p>}\n\n                                        <input\n                                            type=\"text\"\n                                            className=\"form-control shadow-none\"\n                                            placeholder=\"Enter e-mail\"\n                                            {...register(\"email\", {\n                                                required: \"E-mail is required\",\n                                                pattern: {\n                                                    value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\n                                                    message: \"Invalid email address\"\n                                                }\n                                            })}\n                                        />\n                                    </div>\n\n                                    {/* Password */}\n                                    <div className=\"form-group mb-4\">\n                                        {errors.password && errors.password.message ?\n                                            <p className=\"text-danger\">{errors.password && errors.password.message}</p>\n                                            : <p>Password</p>}\n\n                                        <input\n                                            type=\"password\"\n                                            className=\"form-control shadow-none\"\n                                            placeholder=\"Enter password\"\n                                            {...register(\"password\", {\n                                                required: \"Please enter password\",\n                                                minLength: {\n                                                    value: 8,\n                                                    message: \"Minimun length 8 character\"\n                                                }\n                                            })}\n                                        />\n                                    </div>\n\n\n                                    <div className=\"d-flex\">\n                                        <div>\n                                            <Link to=\"/reset\">Forgot password ?</Link>\n                                        </div>\n                                        <div className=\"ms-auto\">\n                                            <PrimaryButton\n                                                type=\"submit\"\n                                                className=\"px-4\"\n                                                disabled={isLogging}\n                                            >{isLogging ? <span>Logging in...</span> : <span>Login</span>}</PrimaryButton>\n                                        </div>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}